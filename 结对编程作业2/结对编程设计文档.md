

# 								结对编程设计文档

---

***



### 目录

### 1. 开发规划

#### 1.1 开发人员

​		吴易佳   刘轩宇

#### 1.2 开发环境和工具

​	

| 环境                   |
| ---------------------- |
| IntelliJ IDEA 2021.1.2 |



#### 1.4 开发规范

- 文档名称：开发规范
- 文档位置：同一目录下



---

***

### 2. 需求分析

#### 2.1需求概述

编写一个四则运算程序，适合小学生们使用，可以随机生成四则混合运算，要求不能出现重复的式子，输入数量和控制范围就能生成对应数量的不超过范围的算式，同时支持对用户给出的答案中的对错进行判定



#### 2.2详细需求分析

- 使用参数控制生成题目的个数

- 使用参数控制题目中数值（自然数、真分数分子和分母）的范围

- 使用参数控制题目中是否带括号

- 生成的题目中如果存在 e1/e2 的子表达式，那么其结果应是真分数

- 每道题目中出现的运算符个数不超过3个

- 程序一次运行生成的题目不能重复（通过运算关系式可以整理成一样的形式就是重复）

- 生成的题目存入执行程序的当前目录下的 Exercise.txt 文件下，格式如下：

  - 序号. 四则运算题目
  - 序号. 四则运算题目

- 在生成题目的同时，计算出所有题目的答案，并且存入执行程序的当前目录下的 Answer.txt 文件下，格式如下：

  - 序号. 答案
  - 序号. 答案

- 程序支持对给定的题目文件和答案文件，判定答案中的对错并进行数量统计，并会输出所有题目中重复的题目，

  统计结果输出到文件 Grade.txt，格式如下：

  - Correct：5（1,3,5,7,9）
  - Wrong：5（2,4,6,8,10）
  - Repeat：2
  - RepeatDetail：
    1. 2, 45+32  Reapeat 3,32+45
    2. 5,3+(2+1)  Reapeat 7, 1+2+3





---

***



### 4 总体设计



#### 4.1 概念术语描述

​		4.1.1 格式化

​			格式化：在录入或者生成四则运算题目时，为了检查题目重复而对题目书写进行了特定排序的表达式。该表达式语义和实际题目是一样的，而只为查重服务，可能不会出现在最终的题目里。例如 1 + 2  格式化为 2 + 1，(1 + 3) + (2 + 4)  格式化为1+2+3+4 

​		4.1.2 后缀表达式

​			a ：不管栈顶元素是左括号还是当前遍历的元素是左括号那么直接压入符号栈

​			b：当前遍历的元素是 + - 优先级是最低的，因为同级的元素不能够放在一起，所以不管栈顶元素是什么那么都要弹出栈中元素直					到当前遍历元素的优先级大于栈顶元素，然后将当前遍历元素压入符号栈即可

​			c：当前遍历的元素是 * / 这个时候需要判断符号栈中的栈顶元素是什么，如果是* / 那么需要弹出栈顶元素直到当前元素优先级大					于栈顶元素，然后将当前遍历元素压入符号栈即可

​		4.1.3 二叉表达式

​			将后缀表达式转化成二叉树的形式，简称二叉表达式：首先准备一个二叉树节点栈s.

​					1、从左开始向右遍历逆波兰式的元素。

​					2、新建一个树节点p，值为当前元素的值。如果取到的元素是操作数，直接把p入栈s；

​						如果是运算符，从栈中弹出2个节点，把第一个弹出的节点作为p的右子树，第二个弹出的节点作为p的左子树，然后把p入						栈。当遍历完成后缀表达式时，树的根节点就保存在栈里了。

----



***

####4.2 基本设计描述

####生成表达式

​		根据题目的要求，表达式中运算符不能超过 3 个，因此所生成的表达式种类可以归纳为以下四类：

- 单算子表达式
    - 型如 A ? B 的表达式
    - 在生成表达式时在 + × 这种拥有交换律的符号时，默认小的在前
- 双算子表达式 
    - 型如 (A ? B) ? C 的表达式
    - 在生成表达式时只要保证括号内的符号满足交换律时，默认按照单算子表达式的顺序，后者如果是 × +，数放在前面
- 三算子 A 型表达式
    - 型如 ((A ? B) ? C) ? D) 的表达式
    - 在生成表达式时，判定重复和双算子表达式一样，只需要保持查重式中 A < B 而无需顾虑 C 和 D
- 三算子 B 型表达式
    - 型如 (A ? B) ? (C ? D) 的表达式
    - 在生成表达式时，保证查重式 A < B 且 C < D 且 A < C 即可

二叉表达式如下：

​		![image-20211007213144421](C:\Users\Gideon\AppData\Roaming\Typora\typora-user-images\image-20211007213144421.png)                     

![image-20211007213204267](C:\Users\Gideon\AppData\Roaming\Typora\typora-user-images\image-20211007213204267.png)



![image-20211007213214288](C:\Users\Gideon\AppData\Roaming\Typora\typora-user-images\image-20211007213214288.png)



![image-20211007213226932](C:\Users\Gideon\AppData\Roaming\Typora\typora-user-images\image-20211007213226932.png)



####除法假分数的避免

除法假分数只会在位于右侧的操作数大于位于左侧的操作数时产生，只需要检查位于左侧的表达式小于或等于右侧的即可。否则，交换除法运算的左右操作数。

####操作数的表示

无论是真假分数还是整数，都可以当成分数来进行计算。在生成操作数的时候，我们就会使用一个分数生成器，按照特定规则，生成分数。而表达式的操作也是分数和分数之间的操作。直到最后生成表达式时，才会将分数进行转化输出。

#### 判断是否重复

因为格式化能确保所有同义的运算式都能输出为同一个算式，所以可以直接将查重式放进 HashSet 中，一旦查询到一个查重式已经存在于 HashSet 中，则证明这个式子已经重复。否则则没有重复。

---



##4.3 主要界面流程描述

###4.3.1 主要界面1（主程序）

​		需要输入各种参数来控制题目的生成

​		然后生成题目，写入文件

​		或者读取文件进行统计

###4.3.2 主要界面2（以下是各文件说明）

​		UserInterface：对输入的题目进行重复判定和结果判定，即批改功能

​		EquationCreation：用于生成符合要求的四则运算题目

​		Fraction：对操作数进行规范化处理，同时计算出结果

​		EquationRegroup：对生成的表达式进行格式化，就是生成后缀表达式

​		Binarytree: 将一个后缀表达式转化为特定形状的二叉树，方便以后进行比较



***

### 4.4模块说明

​	

| 模块名称         |                           功能介绍                           | 备注                                             |
| ---------------- | :----------------------------------------------------------: | ------------------------------------------------ |
| UserInterface    | 这是程序的入口，可以输入参数完成题目的生成，也可以输入文件进行批改 | 调用了UserFile，FileInterface类                  |
| FileInterface    |  可以读入文件并且对四则运算式进行批改，统计结果和重复并返回  | 需要有题目和答案的文件存在                       |
| UserFile         | 用户可以输入一系列参数，然后可以得到两个文件，Exercise文件存放题目，Answer文件存放答案 | 会输出两个文件，如果文件存在，信息将会被覆盖     |
| Fraction         | 由于需要计算含有分子分母的情况,所以把所有的数字都转化为了该类，同时该类有很多的方法，用来对该类进行计算，比如加减乘除 比较 约分等等 | 被许多类进行调用                                 |
| EquationRegroup  | 传入一个字符串表达式, 生成一个队列形式的后缀表达式, 队列里面是字符串形式的 数字和运算式 | 需要与Binary一起使用，得到一个经过格式化的字符串 |
| Binarytree       | 专门为了重复判定而生，内置许多判定方法和操作方法，用来得到特定序列的表达式 | 需要调用EquationRegroup类                        |
| EquationCreation | 用来生成符合要求的表达式，里面包含了多种随机方法，包括生成随机数，随机表达式，随机操作符等等 | 这个类里面生成的随机数需要调用Fraction类得到     |































